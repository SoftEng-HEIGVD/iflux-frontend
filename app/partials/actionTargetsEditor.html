<div class="container">
    <div id="page-content-wrapper">
        <h1>iFLUX Rule Editor</h1>


        <div class="big-panel">
            <div class="col-lg-12 form-horizontal">

                <div class="form-group">
                    <label for="descriptionRules" class="col-sm-2 control-label">Description </label>

                    <div class="col-sm-10"><input id="descriptionRules" name="Description" type="text" class="form-control"
                                                  placeholder="Describe what the rule is supposed to do."
                                                  ng-model="payload.description">
                    </div>
                </div>
                <div class="form-group">
                    <label for="referenceRules" class="col-sm-2 control-label">Reference </label>

                    <div class="col-sm-10"><input id="referenceRules" name="Reference" type="text" class="form-control" placeholder="A human readable reference without space"
                                                  ng-model="payload.reference">
                    </div>
                </div>
                <div class="form-group">
                    <label for="referenceRules" class="col-sm-2 control-label">Enable the rule </label>

                    <div class="col-sm-10">
                        <div>

                            <input bs-switch ng-model="payload.enabled" type="checkbox">

                        </div>
                    </div>

                </div>

            </div>


            <div class="col-lg-6">
                <div class="panel-if">
                    <div>
                        <p class="titleIfThen"><b>IF</b> this event happens...</p>
                    </div>
                    <div class="panel">
                        <div class="panel-red">
                            <div class="panel-heading">
                                Event source: <span><ui-select ng-model="eventSelected.event" theme="bootstrap">
                                <ui-select-match placeholder="Select an event source or do a search">{{$select.selected.displayName}}</ui-select-match>
                                <ui-select-choices repeat="eventSource in eventSources" value="{{$select.selected.event}}">
                                    <div ng-bind-html="eventSource.displayName | highlight: $select.search"></div>
                                    <small>
                                        eventSource: <span ng-bind-html="eventSource.eventSource | highlight: $select.search"></span>
                                    </small>
                                </ui-select-choices>
                            </ui-select></span>

                                <div>
                                    Event type: <input type="text" class="form-control" ng-model="payload.if.eventType"
                                                       placeholder="Event type: *, http://api.flux.io/schemas/userActionEvent ">
                                </div>
                            </div>
                            <div class="panel-body">
                                <div>
                                    <div ng-controller="FormControllerEvent">
                                        <div>
                                            <script type="text/ng-template" id="field_renderer.html">
                                                {{content.title}}
                                                <ul>
                                                    <li ng-repeat="(id, content) in content.properties" ng-include="'field_renderer.html'"></li>
                                                </ul>
                                            </script>
                                            <ul ng-controller="NestedFormCtrl">
                                                <li ng-repeat="(id, content) in schema.properties" ng-include="'field_renderer.html'"></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-6">
                <div class="panel-then">
                    <div>
                        <p class="titleIfThen"><b>THEN</b> trigger this action!</p>
                    </div>
                    <div class="panel">
                        <div class="panel-green">
                            <div class="panel-heading">
                                Action: <span><ui-select ng-model="actionSelected.action" theme="bootstrap">
                                <ui-select-match placeholder="Select an action target or do a search">{{$select.selected.displayName}}</ui-select-match>
                                <ui-select-choices repeat="actionTarget in actionTargets" value="{{$select.selected.action}}">
                                    <div ng-bind-html="actionTarget.displayName | highlight: $select.search"></div>
                                </ui-select-choices>
                            </ui-select></span>

                                <div>
                                    Action Target: <input type="text" class="form-control" ng-model="payload.then.actionTarget"
                                                          placeholder="https://actuator-gateway.iflux.io/api">
                                </div>
                            </div>
                            <div class="panel-body">
                                <div>
                                    <div ng-controller="FormController">
                                        <form sf-schema="schema" sf-form="form" sf-model="actionSchema.properties"></form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-12">
                <div class="buttonbar">
                    <a class="btn btn-primary" ng-click="generate()">Generate the payload</a>
                    <a class="btn btn-primary" ng-click="create()">{{buttonName}}</a>
                </div>
            </div>
        </div>
        {{payload}}

    </div>
</div>